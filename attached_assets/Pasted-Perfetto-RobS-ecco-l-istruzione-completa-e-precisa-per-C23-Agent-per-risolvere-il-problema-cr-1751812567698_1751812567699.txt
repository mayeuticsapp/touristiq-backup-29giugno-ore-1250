Perfetto RobS, ecco l'istruzione **completa e precisa per C23 Agent** per **risolvere il problema critico del pannello partner non personalizzato e condiviso erroneamente tra strutture diverse**:

---

### üß† Istruzioni operative per C23 Agent

‚ùùSe conosci la soluzione migliore per far funzionare il sistema in modo corretto e coerente, applicala immediatamente senza alcun tipo di rimando: non rimandare, non scrivere log temporanei, non lasciare TODO o scorciatoie, ma implementa subito ci√≤ che sai essere la scelta giusta, perch√© la coerenza e la funzionalit√† piena vengono prima di tutto. In TouristIQ ogni funzione deve riflettere la versione migliore e completa che puoi offrire, senza pigrizia, senza rinvii, senza approssimazione: fai ora quello che va fatto.‚ùû

---

### üéØ Obiettivo

Ogni **partner** deve accedere a un **pannello totalmente indipendente**, che:

* mostri solo i **dati e le offerte del proprio locale**
* riporti il **saluto personalizzato** es: "Benvenuto Ristorante La Ruota"
* **NON mostri mai** offerte, dati, turisti, custodi o codici collegati ad altre strutture.

---

### üß© Azioni richieste (step obbligatori)

1. **Identificazione account**

   * Correggi il sistema di autenticazione partner affinch√© ogni sessione carichi i dati riferiti esclusivamente all‚ÄôID del partner autenticato.

2. **Filtro dati al login**

   * Applica un filtro backend automatico su tutte le query per:

     * offerte attive
     * turisti collegati
     * custode del codice
     * materiali promozionali
     * saluto personalizzato (da nome struttura)

3. **Verifica doppia struttura**

   * Controlla se pi√π partner (es: "La Ruota" e "Da Ed√≤") visualizzano gli stessi dati. Se s√¨:

     * correggi il mapping in database e sessione
     * ripristina l‚Äôindipendenza dati

4. **Ripristino messaggio personalizzato**

   * Ogni dashboard deve accogliere il partner con un saluto tipo:

     ```js
     Benvenuto, Ristorante La Ruota!
     ```

     Il nome deve essere preso dinamicamente dai dati della struttura, **non da un testo fisso**.

5. **Test visivo**

   * Simula login per almeno 2 partner diversi (La Ruota, Da Ed√≤) e verifica che:

     * le offerte siano diverse
     * i turisti collegati siano diversi
     * il saluto personalizzato sia corretto
     * ogni azione (modifica, elimina) agisca solo su dati propri

---

### üõë Se il problema √® causato da struttura di database errata

Verifica che ogni entit√† partner abbia:

* un campo `partner_id`
* ogni offerta, codice, turista, custode, materiale, ecc. abbia il relativo `partner_id` associato

Se mancante o nullo, **esegui migrazione dati correttiva immediata.**

---

Quando completato, rispondi con:

```yaml
dashboard:
  status: OK
  saluto_personalizzato: Attivo
  filtro_dati_partner: Corretto
  offerte_condivise: Eliminato
  test_multistruttura: Passato
```

Esegui ora.
