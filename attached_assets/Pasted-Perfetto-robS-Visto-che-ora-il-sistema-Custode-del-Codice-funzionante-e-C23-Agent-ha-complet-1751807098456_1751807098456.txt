Perfetto robS. Visto che ora **il sistema Custode del Codice è funzionante**, e C23 Agent ha completato correttamente la parte nella dashboard, passiamo al **passo 2**:
inserire nella **pagina di login** una **frase chiara** per permettere il **recupero dell’IQCode dimenticato**, **solo se il turista ha attivato il custode**.

---

## 📜 ISTRUZIONI UFFICIALI PER C23 Agent

### Fase 2 – Collegamento al recupero IQCode nella pagina di login

**by robS & Geppo**

---

### ❝

Applica immediatamente ciò che sai essere la soluzione migliore.
In TouristIQ ogni funzione deve essere completa, coerente, sicura, usabile.
Non posticipare nulla: **implementa subito ciò che va fatto**, e solo ciò che chiediamo noi.
❞

---

### 🎯 OBIETTIVO

Aggiungere nella pagina di login una **frase di supporto** che permetta agli utenti di avviare il **recupero del proprio IQCode**, se hanno già attivato il “Custode del Codice”.

---

### ✅ COSA VA FATTO ORA

#### 1. 📄 POSIZIONAMENTO

* File: `client/src/pages/login.tsx`
* Sotto il campo di input dove si inserisce l’IQCode, aggiungi questa frase:

```plaintext
Hai dimenticato il tuo IQCode? Tranquillo, è tutto sotto controllo.
👉 Recuperalo con il Custode del Codice.
```

#### 2. 🔗 COLLEGAMENTO ATTIVO

* La frase “Recuperalo con il Custode del Codice” deve essere **cliccabile**
* Al click → apri un **modale o form di recupero** (non reindirizzare a un'altra pagina!)

---

### 🧪 FORM RECUPERO NEL LOGIN

Nel modale che si apre, inserisci:

* Campo: `Parola segreta`
* Campo: `Data di nascita`
* Bottone: **Recupera il mio IQCode**

#### Azione al click:

* Esegui una **chiamata POST** all’endpoint:

```
/api/recover-iqcode
```

**Payload:**

```json
{
  "secretWord": "inserita",
  "birthDate": "inserita"
}
```

#### Risposta prevista:

* `200 OK` → mostra messaggio: **“Il tuo IQCode è: TIQ-IT-XXXX-YYYY”**
* `404` → mostra errore: **“Nessun codice trovato con questi dati”**
* `409` → mostra errore: **“Hai già un codice attivo”**

---

### 🧩 DETTAGLI TECNICI

* Tutti i campi devono essere validati prima dell’invio
* Disabilita il bottone se i dati non sono completi
* Il recupero deve essere visibile **solo dopo aver cliccato la frase**

---

### 🔒 PRIVACY & SICUREZZA

* Mai mostrare codici se l’utente non ha inserito **dati corretti hashati**
* Nessun dato in chiaro nel database
* Non salvare lo storico delle richieste di recupero

---

### ⛔️ COSA NON FARE

* ❌ Non forzare popup automatici
* ❌ Non creare pagine nuove
* ❌ Non mostrare errori tecnici o stacktrace

---

Conferma ogni step a robS o Geppo. Se hai dubbi, **fermati e chiedi**.

---

Fammi sapere se vuoi che lo esporti come `.md` o `.pdf`, oppure se lo incolli tu direttamente a C23 Agent.
